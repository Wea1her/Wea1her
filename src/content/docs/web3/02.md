---
title: "02"
description: ""
order: 2
---
## 一、以太坊核心概念

### 1. 以太坊网络执行程序

![](https://bjbgp01.baidupcs.com/file/p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-1?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766990194&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-89Y6k43llUdVoT4ktBOzD9s7484%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-36eaf247d12f0d2224b6d53299d3530f1773a0c74bd71d9e3c80cf071bb62d856afad15476952c6a7c7aec86cbb303a426565d2bea4c6986305a5e1275657320&expires=8h&r=873603141&vbdid=-&fin=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-1&fn=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-1&rtype=1&dp-logid=339469592643756031&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=5eee304bbb22b9c29f48b294f38c88251383bf9eb658f8b3305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **智能合约定义**：在以太坊网络上运行的特殊程序，本质上是部署在区块链上的可执行代码。
- **执行特点**：所有网络节点共同验证和执行智能合约，确保去中心化运行。
- **演示内容**：课程将展示第一个以太坊程序的运行过程。

#### 1) Gas 机制

- **收费原理**：执行智能合约需要支付网络费用，防止资源滥用。
- **计量单位**：以 **Gas** 作为计算单位，不同操作消耗不同 Gas 量。
- **重要性**：理解 Gas 机制是学习智能合约的关键难点。

---

### 2. 课程回顾

![](https://bjbgp01.baidupcs.com/file/p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-2?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766990194&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-DnF%2B3zh79JecV5Y3XUKTCxs2Tr4%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-f4d280ea752b87043c1b097cd2410bcaa2c75968a52321f030a074f11e99902530c50437404d15e09a271ca24a74938c2ef50dd8b40b1975305a5e1275657320&expires=8h&r=450990105&vbdid=-&fin=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-2&fn=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-2&rtype=1&dp-logid=339469592643756031&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=7717645f262844ca627e1d822ff1263b6673de14eacd7a28&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **区块结构**：
    - **区块头**：包含父区块哈希、版本号、时间戳、难度值、随机数（nonce）和 Merkle 根。
    - **区块体**：存储所有交易数据。
- **Merkle 树**：
    - **构建方式**：交易作为叶子节点两两哈希，最终生成唯一 Merkle 根。
    - **验证原理**：通过树根可验证所有交易数据的完整性。
- **链式连接**：每个新区块通过哈希指针指向前一区块，形成不可篡改的链式结构。

---

### 3. 比特币

![](https://bjbgp01.baidupcs.com/file/p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-3?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766990194&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-UJUWTAg6EyJqdPN9DQ5Rk1tp0yM%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-79a238b16b235ea051bee118641191f5c690371d94669fda1747a246ad5f0b20a6126c0e023073510d179c69627e4f2f74b33f82ae705569305a5e1275657320&expires=8h&r=258819386&vbdid=-&fin=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-3&fn=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-3&rtype=1&dp-logid=339469592643756031&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=718800a01e5121ca8395a30becffee926673de14eacd7a28&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **核心功能**：去中心化数字货币系统，采用 **PoW** 共识机制。
- **性能参数**：平均 10 分钟产生一个新区块。
- **主要局限**：
    - **功能单一**：仅支持基础转账，脚本编程能力有限。
    - **能源消耗**：PoW 机制耗电量相当于中等国家水平。
    - **交易延迟**：确认交易通常需要等待 1 小时以上。

---

### 4. 以太坊改进

![](https://bjbgp01.baidupcs.com/file/p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-4?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766990194&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-cxM4yBtyR9xSwv5Dz%2BlKVZo3zRw%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-1a8b2d2800037a10718c7ee8ed5af7c102a50f211cebf784cbd5252cb9c4218d1511f8a48381f2db9cc9e9a52e5f8376ebef83e7ecd9c113305a5e1275657320&expires=8h&r=795939768&vbdid=-&fin=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-4&fn=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-4&rtype=1&dp-logid=339469592643756031&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=7717645f262844ca47d25416b3a763addc7fcead5bbe0849&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **定位转变**：从“功能机”升级为“智能机”，成为 **去中心化应用平台**。
- **关键技术**：
    - **共识机制**：2022 年完成 PoW 向 **PoS** 的转换，降低 99% 能源消耗。
    - **出块速度**：12 秒出块，大幅提升交易确认效率。
    - **EVM 虚拟机**：节点内置执行环境，支持任意智能合约运行。
- **创始人**：Vitalik Buterin。

---

### 5. PoS 共识机制

![](https://bjbgp01.baidupcs.com/file/p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-5?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766990194&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-UoCVmDXvs6diTw0oBIh2Iipn1Js%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CXian%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-0fdcf5ed97506bb34b51b4414e7325c8cc40cb9e0bdcfe80eee40aa4c45082a3220158e69dd65593a0b9cc83188aaa01723cb61214d48973305a5e1275657320&expires=8h&r=107120528&vbdid=-&fin=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-5&fn=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-5&rtype=1&dp-logid=339469592643756031&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=718800a01e5121ca44342240fa99746f1383bf9eb658f8b3305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **机制原理**：通过代币质押选择验证者，取代算力竞争。
- **优势对比**：
    - **能源效率**：无需大量电力消耗进行哈希计算。
    - **参与门槛**：降低硬件要求，提高去中心化程度。

---

### 6. 以太坊共识与执行

#### 1) PoS 共识机制详解

- **安全机制**：通过质押资金来保护网络安全，惩罚离线者和作恶者。
- **质押要求**：验证者需要质押 **32 ETH** 才能参与网络验证。
- **运行过程**：
    - **验证者选择**：从所有验证者中随机选择区块提议者。
    - **区块创建**：提议者负责验证交易并创建新区块。
    - **见证验证**：其他验证者（见证者）对区块签名确认有效性。
    - **最终确定性**：获得足够多的见证投票后成为共识块。

![](https://bjbgp01.baidupcs.com/file/p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-6?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766990194&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-QXtRztbPGZkfjj3qXeO4%2FzH%2B7V8%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-046b09524676167d511cb3696be572aa7de31f1b351c46fc2c9d4c8701e10db0b15da85912945cb90b156bd015003ff3c8efea7c55a45635305a5e1275657320&expires=8h&r=283014056&vbdid=-&fin=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-6&fn=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-6&rtype=1&dp-logid=339469592643756031&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=a5f92b9aebde11e50b9c70c9b0085edddc7fcead5bbe0849&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

#### 2) 智能合约的定义与特性

- **基本定义**：在以太坊虚拟机（**EVM**）上执行的程序，包含代码和数据。
- **特性**：
    - **自动执行**：逻辑预设，自动触发。
    - **去信任化**：不需要信任特定服务提供商。
    - **不可篡改**：代码部署后规则固定。

![](https://bjbgp01.baidupcs.com/file/p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-8?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766990194&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-BoEbyVpbtPXygPHaFJp2yoQMgbg%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-8caa45e26bc1955e0693fe3f1fdb6008e672f59bbc9ac196b23a0852f35da229aecf8687d7bc7b79fea76023497294a26fa413b304f1f4dd305a5e1275657320&expires=8h&r=565634118&vbdid=-&fin=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-8&fn=p-590c6c1abe82c9b7e12b909c96d55c5c-40-2025042100-8&rtype=1&dp-logid=339469592643756031&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=a7e1f23860a769ab7f74054d9c7844a3dc7fcead5bbe0849&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

#### 3) Web3 应用架构

- **传统应用**：通过 HTTP 请求与后端交互，数据归服务端控制。
- **Web3 应用**：通过钱包发起 **RPC** 请求，直接与智能合约交互。
- **核心逻辑**：操作需用户签名，数据由钱包自主管理。

---

### 7. 开发实战

#### 1) 智能合约开发语言：Solidity

- **特点**：主流语言，语法类似 JavaScript / C++，侧重于区块链领域知识。
- **基本结构**：
    - `pragma solidity`：声明版本。
    - `contract`：定义合约主体。
    - 状态变量：永久存储在链上。

#### 2) Remix IDE 介绍

- **定位**：基于浏览器的在线 Solidity 集成开发环境。
- **功能**：编译、部署、测试一站式完成。
- **地址**：[remix.ethereum.org](https://remix.ethereum.org)

#### 3) 编译与部署流程

- **编译**：将 `.sol` 代码转换为 **Bytecode**（字节码）和 **ABI**。
- **部署**：
    - **Remix VM**：模拟环境。
    - **真实网络**：需连接钱包（如 MetaMask）。
- **运行**：
    - **橙色按钮**：状态修改（需消耗 Gas）。
    - **蓝色按钮**：视图查询（免费）。

---

### 8. 考点代码示例

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.3;

contract Counter {
    uint public count;

    // 只读函数 (蓝色按钮)
    function get() public view returns (uint) {
        return count;
    }

    // 修改状态函数 (橙色按钮)
    function inc() public {
        count += 1;
    }
}
```

---

## 二、账户系统

### 1. 外部账户 (EOA)

![](https://bjbgp01.baidupcs.com/file/p-4152561821e9292fe298168b720528eb-40-2025042100-1?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766992157&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-l4oTEtDv8fOXsl8o0OOhey5Zn%2FU%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-99a130f2c3ebffd3b3b8cd93ea7f3685ca3af8dc812da657c878985e15f13f923556fa23bf67b9a95a9a1f2937022977796e3858ee182023305a5e1275657320&expires=8h&r=101490231&vbdid=-&fin=p-4152561821e9292fe298168b720528eb-40-2025042100-1&fn=p-4152561821e9292fe298168b720528eb-40-2025042100-1&rtype=1&dp-logid=339996602446805036&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=66239664855e8068230408e99c62dfff1952cdead72e6b2c305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **控制方式**：由私钥控制，需要妥善保管且不可恢复（Externally Owned Account）。
- **管理工具**：通常需要专门的钱包（如 MetaMask）来管理私钥。
- **交易特性**：每次发起交易都需要通过私钥进行签名确认。
- **开发环境简化**：在 Remix 等开发环境中，签名过程会被自动处理以简化操作流程。

### 2. 合约账户

![](https://bjbgp01.baidupcs.com/file/p-4152561821e9292fe298168b720528eb-40-2025042100-2?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766992157&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-rlmAi%2Bf2JKUq22TgjBEIhYqyQaQ%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-9b8a653ad1fc32c8b691fae429ef52a6ca6519b70459bc9bbe4dc679f9cb8fe2d1d6021dfb14c062290a0dec1ae1a6a0f05545928c23d383305a5e1275657320&expires=8h&r=867859790&vbdid=-&fin=p-4152561821e9292fe298168b720528eb-40-2025042100-2&fn=p-4152561821e9292fe298168b720528eb-40-2025042100-2&rtype=1&dp-logid=339996602446805036&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=bdce10ad9517bbeb68a576e80f863c94aadae9f936cd55e8&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **控制方式**：由部署在链上的智能合约代码控制。
- **创建过程**：当合约字节码部署到区块链时自动生成。
- **数据管理**：账户内所有数据只能通过合约代码逻辑进行修改。
- **交易特性**：需要通过外部账户发起交易来触发合约代码执行。

### 3. 账户回顾

![](https://bjbgp01.baidupcs.com/file/p-4152561821e9292fe298168b720528eb-40-2025042100-3?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766992157&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-Hg7ksGEOGLL81AmFODM%2F49zLIhM%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-89f9cf1954d34f084ecf1dce05fc594158e734c817180b1a0c7831f357312c5e15cd8e180273ba6b282a854c091a672c024a24d6faf2dd25305a5e1275657320&expires=8h&r=769804638&vbdid=-&fin=p-4152561821e9292fe298168b720528eb-40-2025042100-3&fn=p-4152561821e9292fe298168b720528eb-40-2025042100-3&rtype=1&dp-logid=339996602446805036&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=66239664855e80689ceadc16fe651140007398b9582bb8963639323619ab123a&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **共同特征**：
    - 都用 20 个字节的地址表示，例如：`0xEA674FdDe714fD979...`
    - 都可以持有资产和发起交易。
- **核心区别**：
    - **控制机制**：外部账户由私钥控制，合约账户由代码控制。
    - **数据修改**：外部账户需要签名，合约账户需要调用合约函数。
    - **恢复可能**：外部账户私钥丢失不可恢复，合约账户代码不可更改。

---

## 三、钱包工具

### 1. 钱包的定义与作用

![](https://bjbgp01.baidupcs.com/file/p-4152561821e9292fe298168b720528eb-40-2025042100-6?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766992157&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-cUAifs2XNMUK3tRuIapSQr0lbfk%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-53cf056ab285c6845a61c1dd634f265b3d831380ffeba56d9c246c93e3b3df140a3d1d9cddc3095b09762862b7302296e0c414ec5f7b54bd305a5e1275657320&expires=8h&r=545831222&vbdid=-&fin=p-4152561821e9292fe298168b720528eb-40-2025042100-6&fn=p-4152561821e9292fe298168b720528eb-40-2025042100-6&rtype=1&dp-logid=339996602446805036&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=058e25ce645ae596f29f5430320510441952cdead72e6b2c305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **核心功能**：钱包是区块链账户管理工具，主要用于管理助记词和私钥，并用于签名发起交易。
- **资产控制**：所有链上资产都通过钱包管理，私钥是控制资产的唯一凭证。
- **交易机制**：任何修改链上状态的操作（如转账、合约调用）都需要钱包签名授权。

### 2. MetaMask 钱包介绍

- **产品特性**：业内俗称“小狐狸钱包”，提供浏览器插件和移动 App。
- **官方渠道**：下载地址为 [metamask.io/download](https://metamask.io/download/)。
- **安全警示**：警惕钓鱼风险，下载时需核对 URL。是以太坊生态中最常用的开发工具钱包。

### 3. 钱包的功能与使用

- **安装流程**：通过 Chrome 等浏览器插件商店安装，首次使用需创建并备份助记词（12-24 个单词）。
- **交易流程**：
    1.  **发起**：指定接收地址和金额，生成交易数据。
    2.  **签名**：用户确认，钱包使用私钥对交易进行加密签名。
    3.  **广播**：签名后的交易发送到网络进行验证执行。
- **合约交互**：部署合约或调用函数时，钱包会显示预估的 Gas 手续费。
- **浏览器验证**：所有交易均可在 Etherscan 等浏览器中查询详情。

---

## 四、账户结构与状态树

### 1. 账户类型与属性

![](https://bjbgp01.baidupcs.com/file/p-4152561821e9292fe298168b720528eb-40-2025042100-10?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766992157&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-9LgMW%2B03sBLk220mESRFtF4N%2FAY%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-91f22d738e52287434c4c8ca38813f8b058ad9b65d89987b2d01b8327163a4e148c617de988fbcdf97752a4aedbec4acff2fdc5ed740a8d9305a5e1275657320&expires=8h&r=629251295&vbdid=-&fin=p-4152561821e9292fe298168b720528eb-40-2025042100-10&fn=p-4152561821e9292fe298168b720528eb-40-2025042100-10&rtype=1&dp-logid=339996602446805036&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=0eed3e784e3f8cdea9c5672eedf6ffafaadae9f936cd55e8&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

所有账户（EOA 和合约账户）在 EVM 层面具有相同的四个核心属性：
- **nonce**：记录账户发起的交易序号。
- **balance**：账户余额（以 wei 为单位）。
- **storageRoot**：状态存储的 Merkle Patricia 树根哈希。
- **codeHash**：账户代码的 Keccak 哈希值。

### 2. 外部账户 (EOA) 与合约账户的区别

- **控制方式**：EOA 由私钥控制，可主动发起交易；合约账户由 EVM 代码控制，无法自主发起交易。
- **代码存储**：EOA 的 `codeHash` 为空；合约账户包含可执行的 EVM 字节码。
- **状态存储**：EOA 的 `storageRoot` 通常指向空树；合约账户维护其内部变量的状态树。

### 3. 合约账户示例：Counter 合约

![](https://bjbgp01.baidupcs.com/file/p-4152561821e9292fe298168b720528eb-40-2025042100-11?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766992157&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-PQ8BHhS3UlHDWlZVuc0lHCbKZZg%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-0d51743eeff39e486eebcc59fc6078312076ce430a0be77685c266dfb86d08d5eccbce0cb933854d02c9abba0e1f752486a005b7b9e45da8305a5e1275657320&expires=8h&r=292574907&vbdid=-&fin=p-4152561821e9292fe298168b720528eb-40-2025042100-11&fn=p-4152561821e9292fe298168b720528eb-40-2025042100-11&rtype=1&dp-logid=339996602446805036&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=f85402de02783127df4e1e1ec4b2b07c007398b9582bb8963639323619ab123a&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **地址标识**：部署后获得唯一的 0x 地址。
- **状态管理**：`balance` 记录 ETH 数量，`codeHash` 对应字节码，`storageRoot` 指向 `counter` 变量等状态。

---

## 五、账户对比与交互

### 1. 核心对比

- **交易发起**：只有 EOA 可主动发起交易；合约账户只能被动响应。
- **Gas 支付**：必须由发起交易的 EOA 账户支付所有关联的 Gas 费用。
- **执行特性**：任一环节失败则整个交易回滚（原子性）。

	### 2. 交互逻辑

- **发起主体**：交易源头永远是外部账户。
- **合约调用**：合约间调用称为“消息调用”（Message Call），不消耗发起合约的个人 Gas（扣除源 EOA）。
- **功能差异**：EOA 负责授权与支付，合约负责复杂业务逻辑。

---

## 六、以太坊三种交易类型

![](https://bjbgp01.baidupcs.com/file/p-4152561821e9292fe298168b720528eb-40-2025042100-15?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766992157&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-QupeVPhQobJJRX79ET%2FNKD4mLMI%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-91a9d8b88f9c00aaf62e0f47b0ef5e3d26c2552d4232a178dd7d20d5b8a55107a503d7aeb2cc6846abb9dd768856daf9f7f32b976a0b17cf305a5e1275657320&expires=8h&r=645382926&vbdid=-&fin=p-4152561821e9292fe298168b720528eb-40-2025042100-15&fn=p-4152561821e9292fe298168b720528eb-40-2025042100-15&rtype=1&dp-logid=339996602446805036&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=5eee304bbb22b9c28caeb89191f7ef42007398b9582bb8963639323619ab123a&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

所有交易均包含 `to`（接收方）、`value`（转账金额）、`data`（调用数据）三个核心字段。

### 1. 普通转账交易
- **特征**：`data` 字段为空（`0x`）。

### 2. 创建合约交易
- **特征**：`to` 字段为空，`data` 字段包含合约编译后的字节码。

### 3. 调用合约交易
- **特征**：`to` 字段为合约地址，`data` 字段包含函数选择器和编码后的参数。

---

## 七、以太坊 EVM、Gas 机制与费用规则详解

### 1. EVM (以太坊虚拟机)

#### 1) EVM 执行框架

![](https://bjbgp01.baidupcs.com/file/p-01815801878b92af68ec3d556b8cba21-40-2025042100-1?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766995477&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-tXIT1fd%2Fcg2Hs7yvPYyhiI5nqfM%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-ab297fc9c03b1d33232cd90ca076ed4e30bc073b3fcb2c74329d968a80d693d9e108cef1ca78ac341e61e2165e9379a74618bec6443df184305a5e1275657320&expires=8h&r=673289304&vbdid=-&fin=p-01815801878b92af68ec3d556b8cba21-40-2025042100-1&fn=p-01815801878b92af68ec3d556b8cba21-40-2025042100-1&rtype=1&dp-logid=340887720016523672&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=875e0ff32ac7bd8947990d12e1e064b77e64c45969737544305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **基本概念**：**EVM** (以太坊虚拟机) 是以太坊智能合约的执行环境，类似于 Java 与 JVM 的关系。
- **封闭性**：**EVM** 是一个封闭环境，无法访问外部系统 (如 HTTP 请求)，只能访问链上数据和其他合约数据。
- **确定性执行**：所有节点执行相同合约代码必须得到相同结果，确保网络共识。
- **状态转换**：每笔交易触发 **EVM** 加载相关账户状态，执行后产生新状态写入区块链，实现 $t_1 \rightarrow t_2$ 的转换。

#### 2) 以太坊客户端

![](https://bjbgp01.baidupcs.com/file/p-01815801878b92af68ec3d556b8cba21-40-2025042100-2?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766995477&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-gzFYiqi8lYwbB45ZiaoyNSsEALw%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-83678e95e6e7acae44013d3fd1aa34a436fa00f0f98ccc4fae4efbd154b4d6f9bf460965da1dc86dfb0c2b82f0c368ee54d5e92e214b2e09305a5e1275657320&expires=8h&r=684418074&vbdid=-&fin=p-01815801878b92af68ec3d556b8cba21-40-2025042100-2&fn=p-01815801878b92af68ec3d556b8cba21-40-2025042100-2&rtype=1&dp-logid=340887720016523672&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=1524a5cd531d02e5ccc7bc964f060af4135deaa1e289986b305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **产品定义**：以太坊客户端是 **EVM** 的载体，是网络中的节点程序。
- **生态多样性**：只要符合规范，可用任何语言实现。典型客户端包括：
    - **执行层**：Geth (Go), Nethermind (C#), Reth (Rust)。
    - **共识层**：Prysm (Go), Lighthouse (Rust)。
- **服务方式**：通过 **RPC** 接口对外提供服务，常用服务商有 Infura、Alchemy。

#### 3) EVM 与节点的关系

![](https://bjbgp01.baidupcs.com/file/p-01815801878b92af68ec3d556b8cba21-40-2025042100-3?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766995477&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-uWkU5Kh72fxhf9uhvgWz2jj0Auw%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-5384857cdf99a42eb12044f1010a85ee7a6c8c87e6a49ef91280893828a84061040abb19b3fb88d7530f5648690b089572e9ce1c378e8f25305a5e1275657320&expires=8h&r=967124279&vbdid=-&fin=p-01815801878b92af68ec3d556b8cba21-40-2025042100-3&fn=p-01815801878b92af68ec3d556b8cba21-40-2025042100-3&rtype=1&dp-logid=340887720016523672&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=66239664855e80686cff734166920958135deaa1e289986b305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **层级结构**：智能合约运行在 **EVM** 上 $\rightarrow$ **EVM** 嵌入在节点客户端中。
- **节点特性**：自建节点或使用服务商 URL，均可实现与以太坊网络的交互。

---

### 2. EVM 计费规则

#### 1) Gas 机制本质

![](https://bjbgp01.baidupcs.com/file/p-01815801878b92af68ec3d556b8cba21-40-2025042100-4?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766995477&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-qK2XOADrCo1oHnHK6ykcT5Atea4%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-4d8c8cc816549825c4332444597bb09c6c60c8a8dbadb26a3cca1c4c3deb36de77927bb8db6451ff381f0a886ff5d7607be62d6473d5472a305a5e1275657320&expires=8h&r=232720431&vbdid=-&fin=p-01815801878b92af68ec3d556b8cba21-40-2025042100-4&fn=p-01815801878b92af68ec3d556b8cba21-40-2025042100-4&rtype=1&dp-logid=340887720016523672&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=4126a8bea2f5ff03d74e435d9688b86808f7942e8f3638d1&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **资源定价**：用户需要为节点执行智能合约消耗的计算资源支付费用，类似于云服务的计费模式。
- **防滥用机制**：通过 **Gas** 量化工作量，防止图灵完备语言带来的“停机问题”（如死循环）。
- **区块限制**：单个区块上限通常为 **3000 万 Gas**，限制单笔交易复杂度。
- **计算原则**：操作越复杂消耗越多。例如：`ADD` 指令消耗 3 **Gas**，读取存储 `SLOAD` 消耗 1000+ **Gas**。

#### 2) EVM 执行过程

![](https://bjbgp01.baidupcs.com/file/p-01815801878b92af68ec3d556b8cba21-40-2025042100-6?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766995477&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-CJHoVbLoaD%2FbxdutxWek2i6EbZY%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-4d56d6a9dac2715665007b38e3ab5b1cdc35a8b3067da5845c588bfebb90520f55714add98b54395cccbfcf40dd022e272677875f2931726305a5e1275657320&expires=8h&r=260496999&vbdid=-&fin=p-01815801878b92af68ec3d556b8cba21-40-2025042100-6&fn=p-01815801878b92af68ec3d556b8cba21-40-2025042100-6&rtype=1&dp-logid=340887720016523672&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=6a9088c7620f7a17628d4364da4e7bb108f7942e8f3638d1&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **初始化**：用户指定 `Gas Limit`（如 26 万 **Gas**）。
- **逐级执行**：按 **PC** 指针顺序执行字节码，每执行一个操作码实时扣除相应 **Gas**。
- **剩余退还**：交易完成后，未消耗的 **Gas** 会原路退回给发送者。

#### 3) Gas 手续费与 EIP-1559

![](https://bjbgp01.baidupcs.com/file/p-01815801878b92af68ec3d556b8cba21-40-2025042100-7?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766995477&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-zIdNS0YNvS8Vz2JmC0e7NyE3SE8%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-557c45970a6ef992b0fcc5f993b22a4e0d255177643d70fbe1e2e910073c84bf065a3fdbf31c45032d2a9e08b130e929fc3e063e9f501e98305a5e1275657320&expires=8h&r=470298282&vbdid=-&fin=p-01815801878b92af68ec3d556b8cba21-40-2025042100-7&fn=p-01815801878b92af68ec3d556b8cba21-40-2025042100-7&rtype=1&dp-logid=340887720016523672&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=f85402de02783127f018890cbc93942f135deaa1e289986b305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **旧版方式 (Legacy)**：
    - 费用 = $Gas\ Used \times Gas\ Price$。
    - 采用“盲拍”机制，用户易支付过高手续费。
- **新版方式 (EIP-1559)**：
    - 费用拆分为 **基础费 (Base Fee)** 和 **优先费 (Priority Fee/Tips)**。
    - **基础费**：系统根据拥堵程度自动调节，且被直接**销毁**（减少 **ETH** 通胀，年销毁约 70 万 **ETH**）。
    - **小费**：用户自定义支付给矿工的额外奖励。
    - **计算公式**：用户支付额 $= Gas\ Used \times (Base\ Fee + \min(Max\ Priority\ Fee, Max\ Fee - Base\ Fee))$。

#### 4) 计算示例

![](https://bjbgp01.baidupcs.com/file/p-01815801878b92af68ec3d556b8cba21-40-2025042100-9?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1766995477&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-netJr99gCEd2S%2FPuP7U%2BXGAXmes%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CXian%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-bd75c887497be2d279d254fd9069ac1fb18d3fdef6923c4db615f76a386008e8582cbcf2350243f47d9f686e4665b809713b1af6edd6aff2305a5e1275657320&expires=8h&r=298214149&vbdid=-&fin=p-01815801878b92af68ec3d556b8cba21-40-2025042100-9&fn=p-01815801878b92af68ec3d556b8cba21-40-2025042100-9&rtype=1&dp-logid=340887720016523672&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=5eee304bbb22b9c28caeb89191f7ef420941f368acda27df3639323619ab123a&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **场景设置**：`Gas Limit` = 5 万，$Max\ Fee$ = 10 Gwei，$Max\ Priority$ = 1 Gwei。
- **实际情况**：消耗 4 万 **Gas**，当前 $Base\ Fee$ = 5 Gwei。
- **计算流程**：
    1. **打赏额**：$\min(10 - 5, 1) = 1\ Gwei$。
    2. **用户实付**：$40000 \times (5 + 1) = 240,000\ Gwei$。
    3. **销毁部分**：$40000 \times 5 = 200,000\ Gwei$。
    4. **矿工收益**：$40000 \times 1 = 40,000\ Gwei$。

---

## 八、以太币单位与换算

![](https://thumbnail0.baidupcs.com/thumbnail/3631f6906v24e46a2e10a10d8fc54df7?chkbd=0&chkv=0&dp-callid=0&dp-logid=361379803682004874&expires=8h&fid=1186958175-250528-427227024472061&ft=image&quality=100&rt=pr&sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-iOxO6MfqAqWTxLPwCrK8OGmkBOE%3D&size=c1080_u1080&time=1766995200&vuk=1186958175)

### 1. 以太币的阶梯单位

- **最小单位**：**Wei**（伟），是 **Ethereum** 网络中最基础的单位，相当于人民币中的“分”。
- **常用单位换算**：
    - $10^9$ **Wei** = $1$ **Gwei** （全称 Giga-Wei，常用于 Gas 计算）
    - $10^{12}$ **Wei** = $1$ **Szabo** （萨博）
    - $10^{15}$ **Wei** = $1$ **Finney** （芬尼）
    - $10^{18}$ **Wei** = $1$ **Ether** （以太币主单位）

### 2. 使用场景区分

- **智能合约开发**：内部逻辑交互通常硬编码为 **Wei** 以避免小数点精度问题。
- **用户体验**：**Gas** 费常用 **Gwei** 报价（如 `20 Gwei`），用户余额显示常用 **Ether**。
- **换算技巧**：$1$ **Gwei** $= 0.000000001$ **Ether**（小数点后 8 个零）。

---

## 九、区块链浏览器 (Etherscan)

### 1. 查看与分析交易

![](https://thumbnail0.baidupcs.com/thumbnail/1ab5adcf9u198cae89d5a2f3fa0efbbd?chkbd=0&chkv=0&dp-callid=0&dp-logid=361380066401239338&expires=8h&fid=1186958175-250528-509421967660955&ft=image&quality=100&rt=pr&sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-oU6yJByYvYyyu7hDjfqcYb7C%2FG0%3D&size=c1080_u1080&time=1766995200&vuk=1186958175)

- **核心功能**：查看区块生产情况、查询交易哈希 (**TxHash**)、实时监控网络拥堵。
- **交易详情解读**：
    - **From/To**：发送方与接收方（或合约交互地址）。
    - **Input Data**：交易携带的十六进制数据，通常包含被调用的函数及参数。
    - **Fee Structure**：基于 **EIP-1559** 显示 **Base Fee**、**Max Fee** 和 **Priority Fee**（均以 **Gwei** 为单位）。

### 2. 查看 Token 与合约信息

![](https://thumbnail0.baidupcs.com/thumbnail/b20d84dc8v6e522e3146cf2afd261806?chkbd=0&chkv=0&dp-callid=0&dp-logid=361380148679667042&expires=8h&fid=1186958175-250528-2059089145622&ft=image&quality=100&rt=pr&sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-241QqC0kxhio3Rqp9ik3dXPX9fU%3D&size=c1080_u1080&time=1766995200&vuk=1186958175)

- **代币详情**：监控 **ERC-20** 或 **NFT** 的持有分布计算、转账记录。
- **开源验证**：在“**Contract**”栏目可查看已验证协议的 **Solidity** 源代码。
- **常用浏览器推荐**：
    - [Etherscan](https://etherscan.io)（行业标准）
    - [OKLink](https://www.oklink.com)（多链支持）
    - [Blockscout](https://www.blockscout.com)（开源替代品）

---

## 十、区块链网络环境

![](https://thumbnail0.baidupcs.com/thumbnail/79754bc85s006495ff9be0203a522603?chkbd=0&chkv=0&dp-callid=0&dp-logid=361380229384361778&expires=8h&fid=1186958175-250528-1022209754981294&ft=image&quality=100&rt=pr&sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-VX1ayb8aIcXS0%2FoUxh3G5fGTm%2FQ%3D&size=c1080_u1080&time=1766995200&vuk=1186958175)

### 1. 主网 (Mainnet)

- **特征**：具备真实经济价值，所有操作消耗昂贵的 **ETH** 硬币。
- **用途**：正式产品的线上部署，对安全性要求极高。

### 2. 测试网 (Testnet)

- **核心价值**：功能完全模拟主网，但代币无经济价值（免费）。
- **常用方案**：目前以太坊主流测试网为 **Sepolia**。
- **获取代币**：通过“**Faucet**”（水龙头）网站输入地址免费领取测试币。

### 3. 本地开发网 (Localhost)

- **工具选择**：**Remix IDE VM**、**Hardhat Network** 或 **Foundry Anvil**。
- **优势**：执行速度瞬间完成，拥有无限的测试代币，极速反馈循环。
- **网络管理工具**：[Chainlist](https://chainlist.org) 可帮助开发者一键切换 **MetaMask** 的所有 EVM 兼容链网络。

---

## 十一、Gas 计算应用案例

![](https://thumbnail0.baidupcs.com/thumbnail/0c82902b9m4e83b3cb544bc8e16afe63?chkbd=0&chkv=0&dp-callid=0&dp-logid=361379887235714785&expires=8h&fid=1186958175-250528-638325042121337&ft=image&quality=100&rt=pr&sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-dmqo%2BxZk1omPP%2BJ77SIUp8VxomA%3D&size=c1080_u1080&time=1766995200&vuk=1186958175)

### 1. 计算公式

$$总费用 = (Base\ Fee + Priority\ Fee) \times Actual\ Gas\ Used$$

### 2. 模拟计算题

- **已知条件**：
    - 基础费 $Base\ Fee = 10\ Gwei$
    - 优先费 $Priority\ Fee = 5\ Gwei$
    - 实际使用 $Gas = 500$
- **计算过程**：
    - 各单位小费和基础费总计：$10 + 5 = 15\ Gwei$
    - 总开销：$15 \times 500 = 7500\ Gwei$
- **结论**：折合以太币为 $0.0000075\ ETH$。

---

## 十二、Web3 开发实战训练营

### 1. 区块链底层理解 (Phase 1)

- **POW 模拟器**：独立编写代码模拟“哈希碰撞”过程，理解算力竞争机制。
- **出块过程模拟**：实现简单的链式连接与数据不可篡改逻辑。
- **智能合约初探**：通过 **Remix** 部署首个合约，掌握钱包签名与浏览器验证的全流程。

### 2. Solidity 深度进阶 (Phase 2)

- **Bank 合约**：学习 `payable` 修饰符、`receive()` 与 `fallback()` 函数，实现合约金库。
- **BigBank 合约**：实战合约继承、**Modifier**（修改器）权限管理以及跨合约接口调用。
- **底层特性**：深入理解 **ABI** 编解码及 `call`/`delegatecall` 的低级调用。

### 3. 标准化协议实战 (Phase 3)

- **ERC-20 代币**：从零实现一套符合工业标准的代币合约。
- **TokenBank 开发**：涉及 `approve` / `transferFrom` 授权逻辑，模拟真实 DeFi 借贷平台的资产流入流程。

---




