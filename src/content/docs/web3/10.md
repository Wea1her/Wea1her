---
title: "10"
description: ""
order: 10
---

## 一、 与链交互


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-1?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1767836964&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-xpaEsoB6Ph9T4a2T%2Fhxm%2FApTLIQ%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-41aaa199b80c9c4a38a51c564ebd7ff92ba54d3ec2407f1134c6f640bf6f8429e07543e1d0339c56204fddf0877b9491dbbb7dcae1761f9a305a5e1275657320&expires=8h&r=556117072&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-1&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-1&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=058e25ce645ae596960ae26d525c48ffec6fc377b7584579&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **JSON-RPC 接口**：区块链节点提供的标准交互接口，可通过 **HTTP** 请求直接调用。
- **SDK 封装**：主流语言都有对应的 **SDK** 封装（如 `web3.js` / `ethers.js` / `viem.js` 等），简化开发流程。
- **客户端分类**：
    - `PublicClient`：用于查询链上数据（不同组件库可能称为 `Provider`）。
    - `WalletClient`：用于发起交易，需要签名授权。
- **签名方式**：
    - **后端**：直接导入私钥、助记词、**KeyStore** 等。
    - **前端**：需连接用户钱包（如 **MetaMask**）进行授权。

## 二、 使用 MetaMask 在页面中注入 window.ethereum 对象


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-2?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&time=1767836964&sign=FDTAXUVGEQlBHSKfWqij-GBWOGYTBgG0KqHy7wNbwoLTVMyJyK6xE-MJG4RooIwhX5pZpPcTsuE6a5hu8%3D&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-66020a6d7ed65559ffd5462a41479a41c6904c869dd4e5ff7c8515d63c674e6038b3bcd7a6216575a0494d11ac1c5509f51b8d5990f92f43305a5e1275657320&expires=8h&r=245173175&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-2&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-2&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&csign=dmayhhcqdS1jXSxjkf6DN1P7N8o%3D&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=c77a2290e27174be1f9fb8d325cacafaa14cce3ef1f5f196305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **注入机制**：浏览器插件钱包（如 **MetaMask**）会自动注入全局 `window.ethereum` 对象。
- **授权流程**：需要用户明确授权才能获取账户地址。
- **多账户支持**：可同时授权多个账户，返回地址数组。

### 1）获取用户账号示例


- **核心代码**：
- **实现细节**：
    - 需要指定链信息（如 **Foundry** 测试链）。
    - 使用 `custom transport` 适配不同钱包实现。
    - 完整示例代码参考：`hello_viem` 项目。

### 2）应用演示


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-3?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-5fc9484d2e4bb8ad1206afa8bb7c1444bc6efbd7f8ffd70c7aa69cef01ea702243845dbdaec51aad69eb7e261545047e3e751159bf1ad75f305a5e1275657320&expires=8h&r=377616049&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-3&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-3&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=058e25ce645ae596f29f543032051044a14cce3ef1f5f196305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **状态管理**：
    - 需要跟踪交易状态（`pending` / `confirmed`）。
    - 处理异步操作时的 `loading` 状态。
    - 实时更新链上数据（如余额变化）。
- **开发建议**：
    - **Viem** 库更适合基础交互场景。
    - 复杂 **DApp** 建议使用状态管理更完善的 **Wagmi**。
    - 注意处理网络切换和断开连接的情况。
- **典型实现**：
    - 使用 **React Hooks** 管理状态（`useState` / `useEffect`）。
    - 分离 **Public Client** 和 **Wallet Client**。
    - 需要处理钱包未安装的边界情况。
- **注意事项**：
    - 交易确认可能需要较长时间（不同链差异较大）。
    - 需要处理 **RPC** 请求失败的情况。
    - 前端需要妥善保管 **Session** 而非私钥。

## 三、 Wagmi 前端库


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-4?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-f2bc5b4903b913592d13c14a00afb892085a4de732fbbfed3f979810b32e43e1f62fb84331e78715e2620a03041481d1909393f276730fac305a5e1275657320&expires=8h&r=539666350&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-4&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-4&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=f85402de02783127f018890cbc93942fa14cce3ef1f5f196305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **功能定位**：一个 **React Hooks** 库，专门用于简化 **DApp** 前端开发。
- **核心功能**：
    - **状态管理**：自动维护钱包连接状态、网络变化监听、合约状态缓存与更新。
    - **常用 Hooks**：
        - `useConnect()`：处理钱包连接。
        - `useAccount()`：获取账户信息。
        - `useBalance()`：查询余额。
        - `useReadContract()`：读取合约数据。
        - `useWriteContract()`：写入合约数据。
- **适用场景**：95% 以上的 **Web3** 前端应用使用 **React** 开发。

### 1）Wagmi 简单演示


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-5?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-35fcf60860c6f8caae5de288559e69ab94e3fe678a0bcca084ccb970918f2d1bf9162694e2bf60851a13c22021a9fe43aea054edefdec898305a5e1275657320&expires=8h&r=996583874&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-5&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-5&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=0eed3e784e3f8cdea9c5672eedf6ffafec6fc377b7584579&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **钱包连接**：
    - 代码示例：
    - 实现原理：`injected()` 表示浏览器插件钱包（如 **MetaMask**）。
- **余额查询**：
    - 代码示例：
- **合约交互**：
    - 写入操作：
    - 状态管理：自动处理交易 `pending`、成功、失败等状态。

### 2）Wagmi 安装


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-6?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-498fb813e2cc9f643b115473b0358e56c9d0ee9ce3cd9f35c032599e3b84f6d9cada4b1aae88310af066c56f01f0a66117911e3314cb9aa2305a5e1275657320&expires=8h&r=107817051&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-6&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-6&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=0eed3e784e3f8cde3a4ab4a6287565475620ea320736a9d6&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **安装步骤**：
    - 基础安装：`npm i @reown/appkit-adapter-wagmi wagmi`
    - 完整配置需额外安装：`npm add @tanstack/react-query`
- **配置要点**：
    - 必须创建并导出 `config` 对象。
    - 需要配置支持的链（如 `mainnet`, `sepolia`）。
    - 需要将应用包装在 `WagmiProvider` 中。

### 3）Wagmi 使用演示


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-7?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-6f31b33d5ad9c894bd604c4d5512ebf4de034a368f00493404b29cf037011a72a4b7ea326f35335346998e4c61a21834e8e7422e9be5adf6305a5e1275657320&expires=8h&r=583658730&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-7&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-7&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=0cce998314b34a67afe4033e09cbfe8651beda04731e8c01&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **完整功能演示**：
    - **连接状态管理**：自动处理连接 / 断开连接状态。
    - **链信息获取**：使用 `useChainId()` 和 `useChains()`。
    - **合约交互**：
        - 读取：`useReadContract()`
        - 写入：`useWriteContract()`
- **优势对比**：
    - 相比原生实现，代码量减少 50% 以上。
    - 自动处理所有底层状态管理。
    - 内置错误处理和交易状态跟踪。

## 四、 Web2 vs Web3 登录方式对比

![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-8?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-b1b9212b392bf5b98b912562ae31371a8e698f8f935879ce1aec697aec8a7d241a68c804cf7551e83322ea094972d14d27f3bb5a7be0c253305a5e1275657320&expires=8h&r=833494370&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-8&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-8&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=5eee304bbb22b9c262e485b8428e5c17205656d509ef554d305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **Web2 登录特点**：
    - 传统方式：邮箱 / 密码 或 手机验证码。
    - 主要问题：
        - 各应用账号系统完全独立。
        - 需要管理大量账号密码。
        - 密码泄露风险高（如 **CSDN** 明文泄露事件）。
- **Web3 登录优势**：
    - **统一身份**：钱包地址作为跨应用统一身份。
    - **安全机制**：基于密码学签名而非密码。
    - **新兴方案**：**Passkey** 等生物识别验证方式。
- **发展趋势**：
    - **Web3** 正在整合 **Passkey** 等现代验证方式。
    - **ENS** 等系统提供身份聚合功能。

## 五、 Web2 vs Web3 登录比较


### 1）登录 Web3 应用


**数字钱包概述**

![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-9?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-bb5dbb1fe8c42de02ce37e95c3a00595caca05746521567b361f989e14c4ffa876ecab2f4c94f0142e2e833fa08b193b553b75cb16f769f2305a5e1275657320&expires=8h&r=519404676&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-9&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-9&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=99f1bd1b53bcf330d04e54784f20945b51beda04731e8c01&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **核心功能**：数字钱包是 **Web3** 用户的数字资产之家，用于发送、接收、存储和显示通过以太坊和 **EVM** 链的数字资产。
- **创新特性**：不同于传统银行账户，用户完全掌控资产所有权，只需连接钱包即可访问各类 **Web3** 应用。
- **主流钱包类型**：
    - 浏览器插件钱包（如 **MetaMask**）
    - 移动端钱包（如 **Rainbow**、**Coinbase Wallet**）
    - 硬件钱包（如 **Ledger**）
    - 智能合约钱包（如 **Argent**）

**钱包登录机制**

![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-10?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-5b1378f5cd9499d32d22d63c535a98d8437c5e22cfcb95292b56c9cb48c8fd77c678b103f4ec04ec7467966eb01ab0ea977bd181f063a702305a5e1275657320&expires=8h&r=651647443&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-10&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-10&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=e83ff6a139489830f86b48b6506bb92c5620ea320736a9d6&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **通用身份体系**：通过 **ENS**（以太坊域名服务）实现跨应用身份识别，例如 `vitalik.eth` 等 `.eth` 域名可解析用户所有加密地址。
- **自动显示功能**：当用户拥有 **ENS** 时，登录 **Web3** 应用会自动显示注册的域名和关联的 **NFT** 头像等信息。
- **典型问题**：网络连接问题可能导致钱包弹窗延迟或失败（如“网络有些问题拿不到”的情况）。

**Web2与Web3登录对比**

![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-11?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-5ac231e86e670892c4d4a9ac1c5cb240576e0bc1aaecdc8802e48f95844cfec8522012f7fa4ac5c62fd97cccddb4da4afad5ea777a428bd2305a5e1275657320&expires=8h&r=607936428&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-11&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-11&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=5eee304bbb22b9c29f48b294f38c8825205656d509ef554d305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **Web2 痛点**：
    - 需在每个网站重复注册。
    - 管理多组用户名密码。
    - 存在弱密码和盗号风险。
- **Web3 优势**：
    - 去中心化身份（通过 **EIP-1193** 标准实现）。
    - 同一加密身份跨应用通用。
    - 自动关联 **ENS** 域名和数字资产信息。
- **技术标准**：钱包登录遵循 **EIP-1193** 规范，**MetaMask** 是最早实现该标准的钱包之一。

**钱包兼容性**

![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-12?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CXian%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-5144661a4c582fbddb3ca2eb5d8b9a6cc6f4d178f2f6da95b8a58623e5d9b938985b1433dab9614bc484fac89b707d8888b35f918d681eac305a5e1275657320&expires=8h&r=320518366&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-12&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-12&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=718800a01e5121ca8395a30becffee925620ea320736a9d6&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **钱包多样性**：除 **MetaMask** 外，还有 **OKX Wallet**、**Phantom**、**Rabby** 等兼容 **EIP-1193** 的钱包。
- **冲突处理**：同时安装多个钱包扩展可能导致冲突，需要禁用部分钱包（如“有冲突”的情况）。
- **开发调试**：**Chrome** 开发者模式可管理钱包扩展，方便开发者测试不同钱包的集成效果。

**实际应用案例**

![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-13?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-1da126a37fd413e02aa62604a912744ae8fddbbdd4adccc1f394a0041be85988b1e2d7e6320731c15ea9955913cdb6b074acffcf5cefff2c305a5e1275657320&expires=8h&r=704066304&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-13&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-13&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=718800a01e5121ca44342240fa99746f205656d509ef554d305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **身份整合**：用户 `tinyxiong.eth` 的 **ENS** 域名同时关联：
    - **Web3** 应用中的显示名称。
    - **NFT** 头像资产。
    - **Twitter** 等 **Web2** 平台的昵称。
- **信息同步**：修改 **ENS** 记录中的个人信息会自动同步到所有集成的 **Web3** 应用。

### 2）DApp 实现加密钱包登录


#### 使用 WalletConnect


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-14?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-a2c899feed5375b5e5338384879d635cde0ed94cec9ab7a59845e83e0030d46b23b2285d6a64acb78c0cd99777bbd833ff8894c83d8785c9305a5e1275657320&expires=8h&r=293406602&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-14&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-14&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=718800a01e5121cabf9c9f5b8bcce45172cd94c4d040cdb2&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **多种连接方式**：
    - 利用 **MetaMask** 注入的 `window.ethereum` 及暴露的接口（**EIP-1193** / **EIP-6963**）。
    - 使用 **WalletConnect** 连接移动钱包。
    - 使用 **AppKit SDK**（原 **Web3Modal**）支持多种钱包连接。
- **接入难点**：需要处理不同钱包的兼容性问题，特别是当用户未安装浏览器插件钱包时，需支持移动端钱包连接。

#### WalletConnect 原理


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-15?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-8e27b257d3afeea66874ef063ccf61d6752274b5bce82a11b5af0e08708308c06d44640c5fbd1dc88cb0c27b8a4dcf5ced7d44cfdd450967305a5e1275657320&expires=8h&r=751685602&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-15&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-15&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=12146e4ffd7df3c9b518a63b7e68801372cd94c4d040cdb2&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **连接流程**：
    1. **DApp** 生成 **WalletConnect** 会话。
    2. **DApp** 显示二维码。
    3. 用户扫描二维码。
    4. 钱包连接到会话。
    5. **DApp** 处理会话确认。
- **关键技术**：
    - 使用二维码（**QR Code**）技术实现扫描登录。
    - 通过桥接服务器（**Bridge Server**）中转信息。
    - 采用对称加密保证通信安全（`symKey` 字段）。
- **会话信息**：
    - 包含会话标识符（`wc:...`）。
    - 过期时间戳（`expiryTimestamp`）。
    - 中继协议（`relay-protocol`）。
    - 对称加密密钥（`symKey`）。

#### 使用 AppKit 登录 SDK


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-16?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-3cf1fc403f74bfc14adb9480ffd95f34dd15a060ba2750acafc5914ee629aa760df1c5633c937ce10dd39849220aa405aa0ad9c990e7286a305a5e1275657320&expires=8h&r=689348060&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-16&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-16&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=12146e4ffd7df3c9955ef6e49f0df6d68d524eba10a8533d305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **平台升级**：**WalletConnect** 升级为 **Reown**，从钱包连接协议发展为链上用户体验平台。
- **核心功能**：
    - 整合钱包功能到应用的 **SDK**。
    - 支持多种钱包登录、社交登录。
    - 提供网络切换（多链支持）。
    - 支持智能合约交互。
- **配套工具**：
    - `AppKit`：面向应用开发者的工具。
    - `WalletKit`：面向钱包开发者的工具。

#### AppKit 接入方法


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-17?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CXian%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-048224fdbfbaa99b2e5ea254fbabcbe7fd573c95c36547b73ad2b0f4d80c6d69705dc2201a18fe86fe656e192a07d729da058b4072c885ff305a5e1275657320&expires=8h&r=571369272&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-17&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-17&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=12146e4ffd7df3c96a9450b557cb230972cd94c4d040cdb2&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **配置步骤**：
    1. 从 **Reown** 云平台获取 `projectId`。
    2. 定义元数据（名称、描述、**URL**、图标等）。
    3. 创建 `WagmiAdapter` 处理底层连接。
    4. 创建 `AppKit` 实例并配置支持网络。
- **实现要点**：
    - 元数据会在钱包连接界面显示，帮助用户识别应用。
    - 需要配置支持的网络列表（如 `[mainnet, arbitrum]`）。
    - 调用 `useAppKit` 的 `open` 函数显示连接模态框。
- **优势**：简化多种钱包接入流程，统一处理连接、网络切换等操作。

## 六、 其他连接库


### 1）RainbowKit


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-18?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-af7140fd841e09104d6ea3ee46afcbe38c98e36f28059d6794373188cc5117b30ebc1d36cfccc6a0ae3a3de539dca9eeee8d07eb52aa9354305a5e1275657320&expires=8h&r=220091225&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-18&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-18&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=12146e4ffd7df3c9b30439175b8086ae72cd94c4d040cdb2&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **专注领域**：专注于 **EVM**（以太坊虚拟机）生态开发。
- **特点**：提供更简单的开发体验，适合以太坊生态应用开发。

### 2）Web3Auth


![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-19?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-fdb308acf4a9374a5cb72d436f7c60fed7319f3e938c36c3a60df319c0b179e906b0e460e75b2fe3ee249f320b5271d0f91c24c27717e583305a5e1275657320&expires=8h&r=207952376&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-19&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-19&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=12146e4ffd7df3c9fc73f631f0eb166b8d524eba10a8533d305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **技术原理**：
    - **MPC 机制**：使用多方安全计算（**MPC**）技术，将私钥分成 3 个分片。
    - **分片存储**：1 片存储在用户设备本地，1 片由 **Web3Auth** 网络管理，1 片作为备份。
    - **签名方式**：各分片可单独签名后合并，或重建完整私钥签名。
- **验证流程**：
    - 通过 **Google** 等社交账号授权验证身份。
    - 返回包含用户邮箱和 **Google** 签名的 **Token ID**。
    - 服务端分片签名后与本地分片合并形成完整签名。
- **优势**：被 **MetaMask** 母公司收购，实现无缝社交登录体验。

### 3）SIWE (Sign-In with Ethereum)


- **基本原理**：

    ![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-20?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CYangquan%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-40e42b3b81673a7da33ce3737e0e80355250c8e1bfac64b8bd8d31ca52b45472f825cd885a7571b5faed5eaeeabf9b5fa15803c5aea5bde6305a5e1275657320&expires=8h&r=844993724&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-20&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-20&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=12146e4ffd7df3c94ad218890403ff7572cd94c4d040cdb2&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

    - **标准定义**：基于 **EIP-4361** 标准（**Sign-In with Ethereum**）。
- **验证流程**：
    1. 用户签署规范消息证明地址控制权。
    2. 后端验证签名实现去中心化认证。
    3. 验证通过后下发 **Session ID** 或 **JWT Token**。
    4. 后续请求携带 **Cookie** 进行身份识别。
- **应用场景**：后端系统需要验证用户身份时使用。

#### 实现方式

![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-21?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3=5&resv4=10&vuk=0&iv=2&vl=0&htype=&randtype=&newver=1&newfm=1&secfm=1&flow_ver=3&pkey=en-644ddbc906d220857c70ab7e6e14c437f1f43a78be55a1059bb4482a144a74106960b80498c9da69032bd24a63906721f74d9ade4e93c692305a5e1275657320&expires=8h&r=280752493&vbdid=-&fin=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-21&fn=p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-21&rtype=1&dp-logid=171842794883342820&dp-callid=0.1&hps=1&tsl=0&csl=0&fsl=-1&so=0&ut=1&uter=-1&serv=-1&uc=256549726&ti=66239664855e8068173f2ae99a7b5b758d524eba10a8533d305a5e1275657320&hflag=30&from_type=&adg=n&reqlabel=250528_n_7bf4850e9a6fbe1b15855a0ec68f78c5_0_69218425c394759ca7e4387773d0582f&chkv=5&bid=250528&by=themis)

- **实现方式**：
    - **消息创建**：
    - **签名请求**：
    - **签名验证**：
    - **会话管理**：验证通过后下发 **Cookie**，后续请求携带该 **Cookie**。

- **实际应用**：
    
    ![](https://bjbgp01.baidupcs.com/file/p-786ec81bb62bd6879c830f5750fa867a-40-2025042100-22?bkt=en-3de6f374fcad9f514a94920d227b7f50&fid=282335-250528-&to=75&size=10&sta_dx=10&sta_cs=0&sta_ft=&sta_ct=7&sta_mt=7&fm2=MH%2CBaoding%2CAnywhere%2C%2CNone%2Cany&ctime=0&mtime=0&dt3=0&resv0=-1&resv1=0&resv2=rlim&resv3